# 📘 데이터 암호화 표준 (DES)

## 📑 목차
1. [DES 개요](#des-개요)
2. [DES 구조](#des-구조)
   - [초기 치환 (Initial Permutation) 및 최종 치환 (Final Permutation)](#초기-치환-initial-permutation-및-최종-치환-final-permutation)
   - [라운드 (Rounds)](#라운드-rounds)
   - [DES 함수 (DES Function)](#des-함수-des-function)
     - [확장 P-box (Expansion P-box)](#확장-p-box-expansion-p-box)
     - [S-박스 (S-boxes)](#s-박스-s-boxes)
     - [스트레이트 P-box (Straight P-box)](#스트레이트-p-box-straight-p-box)
3. [암호화 및 복호화](#암호화-및-복호화)
4. [키 생성](#키-생성)
5. [참고 문헌](#참고-문헌)

## DES 개요
데이터 암호화 표준 (DES, Data Encryption Standard)은 1973년 미국 국가 표준국(NBS, 현재 NIST)이 국가 대칭키 암호 시스템을 위해 제안한 알고리즘으로, IBM의 Lucifer 프로젝트를 개량한 것입니다. DES는 1975년 FIPS 초안으로 발표되었습니다. DES는 블록 암호로, 64비트 평문과 56비트 키를 사용하여 64비트 암호문을 생성합니다.

- **64비트 평문** + **56비트 키** → **DES 암호화** → **64비트 암호문**
- **64비트 암호문** + **56비트 키** → **DES 복호화** → **64비트 평문**

## DES 구조
DES는 암호화 및 복호화를 위해 다음과 같은 주요 구조로 구성됩니다:

### 🌀 초기 치환 (Initial Permutation) 및 최종 치환 (Final Permutation)
DES는 64비트 평문을 입력받아 초기 치환 테이블을 사용하여 비트를 재배열한 후 16개의 라운드를 거쳐 최종 치환 테이블을 사용하여 암호문을 생성합니다. 초기 치환과 최종 치환은 각각 64비트의 입력 비트를 미리 정해진 규칙에 따라 변경하여 출력합니다. 이 과정은 암호화 키를 사용하지 않으며, 암호학적 중요성은 없습니다. 단지 데이터의 복잡성을 높이기 위한 전처리 및 후처리 단계로 볼 수 있습니다.

#### 🗂 초기 치환 테이블  
```
58 50 42 34 26 18 10 02  
60 52 44 36 28 20 12 04  
62 54 46 38 30 22 14 06  
64 56 48 40 32 24 16 08  
57 49 41 33 25 17 09 01  
59 51 43 35 27 19 11 03  
61 53 45 37 29 21 13 05  
63 55 47 39 31 23 15 07
``` 

#### 🗂 최종 치환 테이블
```
40 08 48 16 56 24 64 32  
39 07 47 15 55 23 63 31  
38 06 46 14 54 22 62 30  
37 05 45 13 53 21 61 29  
36 04 44 12 52 20 60 28  
35 03 43 11 51 19 59 27  
34 02 42 10 50 18 58 26  
33 01 41 09 49 17 57 25
```


### 🔄 라운드 (Rounds)
DES는 16개의 라운드를 사용하며, 각 라운드는 Feistel 암호 구조를 따릅니다. 각 라운드는 두 개의 주요 요소, 믹서 (Mixer)와 스와퍼 (Swapper)로 구성됩니다. 믹서는 XOR 연산을 사용하여 가역성을 보장하고, 스와퍼는 데이터를 교환하여 암호화를 진행합니다.

- **🔄믹서 (Mixer)**: XOR 연산을 통해 비트를 혼합하여 혼돈 (Confusion)을 제공
- **🔄스와퍼 (Swapper)**: 좌우 비트를 교환하여 확산 (Diffusion)을 제공

#### 라운드 과정
1. 각 라운드는 초기 치환 또는 이전 라운드의 출력에서 L_i와 R_i를 입력으로 받습니다.
2. R_i는 DES 함수 f(R_i, K_i)의 입력으로 사용되며, 이 함수는 확장 P-box, S-박스 및 스트레이트 P-box의 단계를 거칩니다.
3. DES 함수의 출력은 L_i와 XOR 연산이 수행되어 새로운 R_(i+1)을 생성합니다.
4. R_i는 L_(i+1)이 됩니다.
5. 최종 라운드에서는 L_(16)과 R_(16)이 결합되어 최종 치환을 거쳐 64비트 암호문을 생성합니다.

### 🛠 DES 함수 (DES Function)
DES의 핵심 부분은 DES 함수로, R_i와 K_i를 입력받아 32비트 출력을 생성하는 함수입니다. 이 함수는 네 가지 주요 변환 절차를 수행합니다.

#### 🛠 확장 P-box (Expansion P-box)
첫 번째 단계는 32비트 입력 R_i를 48비트로 확장하는 것입니다. 이를 위해 확장 P-box를 사용합니다.

- **🛠 32x48 확장 P-box 퍼뮤테이션 테이블**
```
32 01 02 03 04 05  
04 05 06 07 08 09  
08 09 10 11 12 13  
12 13 14 15 16 17  
16 17 18 19 20 21  
20 21 22 23 24 25  
24 25 26 27 28 29  
28 29 30 31 32 01  
```

#### 🛠 S-박스 (S-boxes)
XOR 연산 결과인 48비트를 6비트씩 분리하여 8개의 S-box에 입력으로 넣고 32비트 출력을 생성합니다. 각 S-box는 6비트 입력을 받아 4비트를 출력합니다.

- **🛠 S-box 1 예시**
```
14 04 13 01 02 15 11 08 03 10 06 12 05 09 00 07  
00 15 07 04 14 02 13 01 10 06 12 11 09 05 03 08  
04 01 14 08 13 06 02 11 15 12 09 07 03 10 05 00  
15 12 08 02 04 09 01 07 05 11 03 14 10 00 06 13
```

#### 🛠 스트레이트 P-box (Straight P-box)
마지막 단계는 스트레이트 P-box를 통해 직전 8개의 S-box 출력 32비트의 위치를 변환하여 32비트 출력을 생성하는 것입니다.

- **🛠 32x32 스트레이트 P-box 퍼뮤테이션 테이블**
```
16 07 20 21  
29 12 28 17  
01 15 23 26  
05 18 31 10  
02 08 24 14  
32 27 03 09  
19 13 30 06  
22 11 04 25
```


## 🔐 암호화 및 복호화
DES 암호화와 복호화는 매우 유사하게 설계되었습니다. 암호화 과정에서는 16개의 라운드를 거쳐 암호문을 생성하며, 복호화 과정에서는 이 라운드 키를 역순으로 적용하여 평문을 복원합니다.

- **🔐 암호화 과정**
1. 64비트 평문이 초기 치환을 거칩니다.
2. 16개의 라운드를 거쳐 암호화가 진행됩니다.
3. 최종 치환을 통해 64비트 암호문이 생성됩니다.

- **🔐 복호화 과정**
1. 64비트 암호문이 초기 치환을 거칩니다.
2. 16개의 라운드를 역순으로 적용하여 복호화가 진행됩니다.
3. 최종 치환을 통해 64비트 평문이 복원됩니다.

## 🗝 키 생성
DES 암호화 키는 일반적으로 56비트 대신 패리티 비트가 포함된 64비트로 주어집니다. 키 생성 과정은 다음과 같습니다.

1. **🗝 패리티 드롭 (Parity Drop)**: 패리티 비트를 제거하고 나머지 비트들의 위치를 변경합니다.
 - **🗝 패리티 드롭 퍼뮤테이션 테이블**
   ```
   57 49 41 33 25 17 09 
   01 58 50 42 34 26 18 
   10 02 59 51 43 35 27 
   19 11 03 60 52 44 36 
   63 55 47 39 31 23 15 
   07 62 54 46 38 30 22 
   14 06 61 53 45 37 29 
   21 13 05 28 20 12 04
   ```

2. **🗝 좌측 순환 이동 (Shift Left)**: 1, 2, 9, 16 라운드에서는 한 비트씩, 나머지 라운드들에서는 두 비트씩 좌측 순환 이동을 수행합니다.

3. **🗝 압축 P-box (Compression P-box)**: 56비트를 입력받아 라운드 키로 사용될 48비트를 출력합니다.
 - **🗝 56x48 압축 P-box 퍼뮤테이션 테이블**
   ```
   14 17 11 24 01 05 
   03 28 15 06 21 10 
   23 19 12 04 26 08 
   16 07 27 20 13 02 
   41 52 31 37 47 55 
   30 40 51 45 33 48 
   44 49 39 56 34 53 
   46 42 50 36 29 32 
   ```
