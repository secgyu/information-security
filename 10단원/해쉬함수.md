# 📘 Cryptographic Hash Functions

## 📑 목차
1. 암호학적 해쉬 함수
   - 개념및 특성
   - 실행 예
   - 응용
   - 요구사항
2. 해쉬 함수 충돌 확률
3. Merkle-Damgård Scheme
4. 해쉬 알고리즘 비교
5. 해쉬 함수 응용: 메시지 인증 (MAC)
6. 해쉬 함수 응용: 전자서명
7. 해쉬 함수 응용: 패스워드 기반 개체 인증

### 🔒 개념 및 특성
암호학적 해쉬 함수는 임의 크기의 메시지를 입력받아 고정 크기의 해쉬 값을 출력하는 함수입니다. 주요 특성은 다음과 같습니다:
- **역상 저항성 (Preimage Resistance)**: 주어진 해쉬 값을 생성하는 원래 메시지를 찾는 것이 계산적으로 불가능해야 합니다.
- **제2 역상 저항성 (Second Preimage Resistance)**: 주어진 메시지와 동일한 해쉬 값을 가지는 다른 메시지를 찾는 것이 계산적으로 불가능해야 합니다.
- **충돌 저항성 (Collision Resistance)**: 동일한 해쉬 값을 생성하는 두 개의 다른 메시지를 찾는 것이 계산적으로 불가능해야 합니다.

### 📝 실행 예
- **파일 A와 파일 B의 해쉬 값 비교**:
  - A.txt: `Seoul`
  - B.txt: `seoul`
  - `certutil -hashfile A.txt MD5` 결과: `Fd38499c5c04df42d1d78807aa4b7d7d`
  - `certutil -hashfile B.txt MD5` 결과: `D793880d5ba70feb1c2e259d1a373add`

### 🔍 응용
암호학적 해쉬 함수는 다양한 응용 분야에서 사용됩니다.
- **메시지 인증 (Message authentication)**: 수신 메시지가 송신측이 보낸 (변경되지 않는 진짜) 메시지인지 확인합니다.
- **디지털 서명 (Digital signatures)**: 메시지의 해쉬 값에 대해 송신측의 개인키로 디지털 서명을 수행하여 메시지의 무결성과 출처를 증명합니다.
- **패스워드 검증**: 패스워드의 해쉬 값을 저장하고, 로그인 시 입력된 패스워드의 해쉬 값을 이전에 저장된 해쉬 값과 비교합니다.
- **침입 탐지와 바이러스 탐지**: 시스템 내 파일의 해쉬 값을 계산하여 변경 여부를 탐지합니다.

### 🛠 요구사항
안전한 해쉬 함수가 갖추어야 할 3가지 핵심 특성은 다음과 같습니다:
1. **역상 저항성 (Preimage Resistance)**: 주어진 해쉬 값 h에 대해 h = H(m)을 만족하는 메시지 m을 찾는 것이 계산적으로 불가능해야 합니다.
2. **제2 역상 저항성 (Second Preimage Resistance)**: 메시지 m1이 주어졌을 때, h = H(m1) = H(m2)를 만족하는 다른 메시지 m2를 찾는 것이 계산적으로 불가능해야 합니다.
3. **충돌 저항성 (Collision Resistance)**: 동일한 해쉬 값을 생성하는 서로 다른 두 메시지 m1과 m2를 찾는 것이 계산적으로 불가능해야 합니다.

## 🎲 해쉬 함수 충돌 확률
비둘기집 원리에 따라, 해쉬 함수의 출력 크기가 n 비트인 경우 충돌을 찾기 위해 필요한 메시지의 수는 약 \(2^{n/2}\)개입니다.

## 🛡 Merkle-Damgård Scheme
Merkle-Damgård 구조는 임의 길이의 메시지를 고정 길이의 출력으로 변환하는 해쉬 함수 구조입니다. 메시지를 패딩하고 비트 블록으로 분할하여 각 블록에 반복적으로 압축 함수를 적용합니다.

## 🎂 생일 문제와 생일 역설
### 생일 문제
생일 문제는 \( n \)명의 사람 중 같은 생일을 가진 사람이 있을 확률을 구하는 문제입니다. 이 문제는 해쉬 함수 충돌 확률과 유사한 개념으로, 해쉬 값의 충돌 확률을 계산할 때 사용됩니다.

### 생일 역설
생일 역설은 23명의 사람 중 50% 이상의 확률로 두 사람이 같은 생일을 가질 확률이 있다는 역설적인 결과를 의미합니다. 이는 해쉬 함수에서 충돌이 얼마나 쉽게 발생할 수 있는지를 보여주는 좋은 예입니다.

#### 예제: 생일 역설 확률 계산
```python
import math

def birthday_paradox_probability(n):
    return 1 - math.exp(-n * (n - 1) / (2 * 365))

# 예제 사용법
probability = birthday_paradox_probability(23)
print(f"23명의 사람 중 같은 생일을 가진 사람이 있을 확률: {probability * 100:.2f}%")
```

## 🏆 해쉬 알고리즘 비교
- **MD5**: 128비트 해쉬 값을 생성합니다.
- **SHA-1**: 160비트 해쉬 값을 생성합니다.
- **SHA-2**: 다양한 변형(SHA-224, SHA-256, SHA-384, SHA-512)을 포함하며, 각각 224, 256, 384, 512비트 해쉬 값을 생성합니다.
- **SHA-3**: 최신 해쉬 알고리즘으로 다양한 출력 크기를 지원합니다.

## 🔑 해쉬 함수 응용: 메시지 인증 (MAC)
MAC (Message Authentication Code)은 메시지 인증과 무결성을 제공하기 위해 사용됩니다. 송신측은 메시지와 공유키를 이용하여 MAC을 생성하고, 수신측은 수신된 메시지와 공유키로부터 MAC을 생성하여 비교합니다.

## 🔏 해쉬 함수 응용: 전자서명
전자 서명은 송신측의 개인키로 메시지의 해쉬 값에 서명을 하여 메시지의 무결성과 출처를 증명합니다. 수신측은 송신측의 공개키로 서명을 검증합니다.

## 🔐 해쉬 함수 응용: 패스워드 기반 개체 인증
패스워드 기반 개체 인증은 사용자 패스워드의 해쉬 값을 저장하고, 로그인 시 입력된 패스워드의 해쉬 값을 이전에 저장된 해쉬 값과 비교하여 인증합니다. 추가적으로 salt를 사용하여 패스워드 해쉬를 강화할 수 있습니다.

### 💻 구현 예제

#### 기본 해쉬 함수 예제 (SHA-256)
```python
import hashlib

def hash_message(message):
    sha256 = hashlib.sha256()
    sha256.update(message.encode('utf-8'))
    return sha256.hexdigest()

# 예제 사용법
message = "Hello, World!"
hash_value = hash_message(message)
print(f"메시지: {message}")
print(f"해쉬 값: {hash_value}")
