# 📘 고급 암호화 표준 (AES)

## 📑 목차
1. AES 개요
2. AES의 역사
3. AES 데이터 단위 – 상태
4. AES 구조 – 라운드
   - SubBytes
   - ShiftRows
   - MixColumns
   - AddRoundKey
5. 키 확장
6. 암호화와 복호화
7. 참고 문헌

## AES 개요
고급 암호화 표준 (AES, Advanced Encryption Standard)은 미국 국립표준기술연구소(NIST)가 DES를 대체할 목적으로 제안한 암호화 알고리즘입니다. AES는 Rijndael 알고리즘을 기반으로 하며, 대칭키 블록 암호입니다. AES는 128비트, 192비트, 256비트 키를 지원하며, 각각 10, 12, 14 라운드의 암호화를 수행합니다.

- **128비트 평문** + **128비트 키** → **AES 암호화** → **128비트 암호문**
- **128비트 암호문** + **128비트 키** → **AES 복호화** → **128비트 평문**

## AES의 역사
1997년, NIST는 DES를 대체할 새로운 암호화 표준을 선정하기 위해 AES 공모를 시작했습니다. 1998년 1차 AES 후보자 회의에서 21개의 후보 중 15개가 선정되었고, 1999년 2차 회의에서 15개 중 5개가 최종 후보로 선정되었습니다: MARS, RC6, Rijndael, Serpent, Twofish. 2000년 3차 회의 후 Rijndael이 AES로 선정되었으며, 2001년 FIPS 197로 발표되었습니다.

- **선정 기준**: 안전성, 비용, 구현 효율성
- **특징**: Non-Feistel 블록 암호, 128비트 블록 크기, 키 크기 128, 192, 256비트 지원

## AES 데이터 단위 – 상태
AES는 내부적으로 "상태"라는 2차원 배열 형태로 데이터를 처리합니다. 초기 128비트 입력 블록은 이 상태 배열에 복사되어 다양한 변환 과정을 거칩니다.

- **State 배열**: 4x4 바이트 배열로 표현

```
EA B2 BD EC 84 B1 EB 8C 80 ED 95 99 EA B5 90 20  
EA 84 80 EA  
B2 B1 ED B5  
BD EB 95 90  
EC 8C 99 20
```

## AES 구조 – 라운드
AES는 여러 라운드로 구성되며, 각 라운드는 네 가지 주요 변환을 포함합니다: SubBytes, ShiftRows, MixColumns, AddRoundKey. 마지막 라운드에서는 MixColumns 변환이 제외됩니다.

### 🔄 SubBytes
SubBytes 변환은 상태 배열의 각 바이트를 S-box를 사용하여 대체합니다. S-box는 256개의 값을 갖는 치환 테이블로, 비선형성을 제공하여 안전성을 높입니다.

- **S-box 테이블**

```
63 7C 77 7B F2 6B 6F C5 30 01 67 2B FE D7 AB 76  
CA 82 C9 7D FA 59 47 F0 AD D4 A2 AF 9C A4 72 C0  
B7 FD 93 26 36 3F F7 CC 34 A5 E5 F1 71 D8 31 15  
04 C7 23 C3 18 96 05 9A 07 12 80 E2 EB 27 B2 75  
09 83 2C 1A 1B 6E 5A A0 52 3B D6 B3 29 E3 2F 84  
53 D1 00 ED 20 FC B1 5B 6A CB BE 39 4A 4C 58 CF  
D0 EF AA FB 43 4D 33 85 45 F9 02 7F 50 3C 9F A8  
51 A3 40 8F 92 9D 38 F5 BC B6 DA 21 10 FF F3 D2  
CD 0C 13 EC 5F 97 44 17 C4 A7 7E 3D 64 5D 19 73  
60 81 4F DC 22 2A 90 88 46 EE B8 14 DE 5E 0B DB  
E0 32 3A 0A 49 06 24 5C C2 D3 AC 62 91 95 E4 79  
E7 C8 37 6D 8D D5 4E A9 6C 56 F4 EA 65 7A AE 08  
BA 78 25 2E 1C A6 B4 C6 E8 DD 74 1F 4B BD 8B 8A  
70 3E B5 66 48 03 F6 0E 61 35 57 B9 86 C1 1D 9E  
E1 F8 98 11 69 D9 8E 94 9B 1E 87 E9 CE 55 28 DF  
8C A1 89 0D BF E6 42 68 41 99 2D 0F B0 54 BB 16  
```

### 🔄 ShiftRows
ShiftRows 변환은 상태 배열의 각 행을 순환 이동시킵니다. 첫 번째 행은 변경되지 않으며, 두 번째 행은 1바이트 왼쪽으로, 세 번째 행은 2바이트, 네 번째 행은 3바이트 순환 이동합니다.

- **ShiftRows 예시**
```
원래 상태:  
01 02 03 04  
05 06 07 08  
09 0A 0B 0C  
0D 0E 0F 10  
```
```
변환 후:  
01 02 03 04  
06 07 08 05  
0B 0C 09 0A  
10 0D 0E 0F
```

### 🔄 MixColumns
MixColumns 변환은 상태 배열의 각 열을 고정된 다항식을 사용하여 새로운 값으로 변환합니다. 이 과정은 각 열을 행렬 곱셈을 통해 변환하며, 데이터의 확산을 증가시킵니다.

- **MixColumns 변환**
```
| 02 03 01 01 | | s0,c | | s'0,c |  
| 01 02 03 01 | • | s1,c | = | s'1,c |  
| 01 01 02 03 | | s2,c | | s'2,c |  
| 03 01 01 02 | | s3,c | | s'3,c |
```

### 🔄 AddRoundKey
AddRoundKey 변환은 상태 배열과 라운드 키를 비트 단위로 XOR 연산을 수행하여 새로운 상태를 생성합니다. 이 변환은 라운드마다 다른 키를 사용하여 보안을 강화합니다.

## 키 확장
AES는 키 확장을 통해 초기 암호화 키로부터 여러 개의 라운드 키를 생성합니다. 키 확장은 고정된 일정한 변환을 통해 라운드 키를 생성하며, 암호화와 복호화 과정에서 사용됩니다.

- **키 확장 과정**
1. 초기 키를 바이트 단위로 나눕니다.
2. 각 바이트를 일정한 규칙에 따라 순환 이동합니다.
3. 각 바이트를 S-box를 통해 대체합니다.
4. 라운드 상수를 더하여 새로운 키를 생성합니다.

- **라운드 상수 (RCon)**
```
01 00 00 00  
02 00 00 00  
04 00 00 00  
08 00 00 00  
10 00 00 00  
20 00 00 00  
40 00 00 00  
80 00 00 00  
1B 00 00 00  
36 00 00 00
```

## 암호화와 복호화
AES 암호화와 복호화는 여러 라운드를 거쳐 수행됩니다. 암호화는 평문을 입력받아 여러 라운드를 통해 암호문을 생성하며, 복호화는 이 과정을 역으로 수행하여 평문을 복원합니다.

- **암호화 과정**
1. 초기 상태 배열에 평문을 복사합니다.
2. 각 라운드에서 SubBytes, ShiftRows, MixColumns, AddRoundKey 변환을 순차적으로 수행합니다.
3. 마지막 라운드에서는 MixColumns 변환을 제외한 나머지 변환을 수행합니다.
4. 최종 상태 배열을 암호문으로 출력합니다.

- **복호화 과정**
1. 초기 상태 배열에 암호문을 복사합니다.
2. 각 라운드에서 InvSubBytes, InvShiftRows, InvMixColumns, AddRoundKey 변환을 순차적으로 수행합니다.
3. 마지막 라운드에서는 InvMixColumns 변환을 제외한 나머지 변환을 수행합니다.
4. 최종 상태 배열을 평문으로 출력합니다.

## 📚 참고 문헌
- [FIPS PUB 197](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.197.pdf)
